<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.75.1" />


<title>Correlation Analysis - A Hugo website</title>
<meta property="og:title" content="Correlation Analysis - A Hugo website">


  <link href='../../../../favicon.ico' rel='icon' type='image/x-icon'/>



  







<link rel="stylesheet" href="../../../../css/fonts.css" media="all">
<link rel="stylesheet" href="../../../../css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="../../../../" class="nav-logo">
    <img src="../../../../images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="../../../../vitae/">CV</a></li>
    
    <li><a href="https://github.com/danli349">GitHub</a></li>
    
    <li><a href="https://scholar.google.com/citations?user=mNjLK8EAAAAJ&amp;hl=en">Googlr Scholar</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">3 min read</span>
    

    <h1 class="article-title">Correlation Analysis</h1>

    
    <span class="article-date">2020-10-18</span>
    

    <div class="article-content">
      
<script src="index_files/header-attrs/header-attrs.js"></script>


<p>Two groups of variables <span class="math inline">\(\mathbf X\)</span> has <span class="math inline">\(p\)</span> variables <span class="math display">\[\mathbf X=\begin{bmatrix}
X_1\\
X_2\\
\vdots\\
X_p\\
\end{bmatrix}\]</span> and <span class="math inline">\(\mathbf Y\)</span> has <span class="math inline">\(q\)</span> variables <span class="math display">\[\mathbf Y=\begin{bmatrix}
Y_1\\
Y_2\\
\vdots\\
Y_q\\
\end{bmatrix}\]</span> <span class="math display">\[E(\mathbf X)=\boldsymbol\mu_X\]</span> <span class="math display">\[Cov(\mathbf X)=\boldsymbol\Sigma_{XX}\]</span> and <span class="math display">\[E(\mathbf Y)=\boldsymbol\mu_Y\]</span> <span class="math display">\[Cov(\mathbf Y)=\boldsymbol\Sigma_{YY}\]</span> and <span class="math display">\[Cov(\mathbf X,\mathbf Y)=\boldsymbol\Sigma_{XY}=\boldsymbol\Sigma_{YX}^T=E(\mathbf X-\boldsymbol\mu_X)(\mathbf Y-\boldsymbol\mu_Y)^T=\begin{bmatrix}
\sigma_{X_1Y_1}&amp;\sigma_{X_1Y_2}&amp;\cdots&amp;\sigma_{X_1Y_q}\\
\sigma_{X_2Y_1}&amp;\sigma_{X_2Y_2}&amp;\cdots&amp;\sigma_{X_2Y_q}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
\sigma_{X_pY_1}&amp;\sigma_{X_pY_2}&amp;\cdots&amp;\sigma_{X_pY_q}\\
\end{bmatrix}\]</span> Linear combinations provide simple summary measures of a set of variables. Let <span class="math display">\[U=\mathbf a^T\mathbf X\]</span> <span class="math display">\[V=\mathbf b^T\mathbf Y\]</span> Then <span class="math display">\[Var(U)=Var(\mathbf a^T\mathbf X)=\mathbf a^TCov(\mathbf X)\mathbf a=\mathbf a^T\boldsymbol\Sigma_{XX}\mathbf a\]</span> <span class="math display">\[Var(V)=Var(\mathbf b^T\mathbf Y)=\mathbf b^TCov(\mathbf Y)\mathbf b=\mathbf b^T\boldsymbol\Sigma_{YY}\mathbf b\]</span> <span class="math display">\[Cov(U,V)=Cov(\mathbf a^T\mathbf X,\mathbf b^T\mathbf Y)=\mathbf a^TCov(\mathbf X,\mathbf Y)\mathbf b=\mathbf a^T\boldsymbol\Sigma_{XY}\mathbf b\]</span> We shall seek coefficient vectors <span class="math inline">\(\mathbf a\)</span> and <span class="math inline">\(\mathbf b\)</span> such that <span class="math display">\[Cor(U,V)=Cor(\mathbf a^T\mathbf X,\mathbf b^T\mathbf Y)=\frac{Cov(\mathbf a^T\mathbf X,\mathbf b^T\mathbf Y)}{\sqrt{Var(\mathbf a^T\mathbf X)}\sqrt{Var(\mathbf b^T\mathbf Y)}}=\frac{\mathbf a^T\boldsymbol\Sigma_{XY}\mathbf b}{\sqrt{\mathbf a^T\boldsymbol\Sigma_{XX}\mathbf a}\sqrt{\mathbf b^T\boldsymbol\Sigma_{YY}\mathbf b}}\]</span> is as large as possible. The <span style="color: red;"><strong>first pair of canonical variables</strong></span> is the pair of linear combinations <span class="math inline">\((U_1,V_1)\)</span> which maximize the correlation <span class="math inline">\(Cor(U,V)\)</span> and has unit variances. The <span style="color: red;"><strong><span class="math inline">\(k^{th}\)</span> pair of canonical variables</strong></span> is the pair of linear combinations <span class="math inline">\((U_k,V_k)\)</span> which maximize the correlation <span class="math inline">\(Cor(U,V)\)</span> and has unit variances and uncorrelated with all of the previous <span class="math inline">\(k-1\)</span> canonical variable pairs.</p>
<ol style="list-style-type: decimal">
<li><p>If variables <span class="math inline">\(x_1,x_2,\cdots,x_p\)</span> and are uncorrelated, the statistical distance from <span class="math inline">\(\mathbf X\)</span> to origin <span class="math inline">\(\mathbf O\)</span> is <span class="math display">\[d(\mathbf X,\mathbf O)=\sqrt{\frac{x_1^2}{s_{11}}+\frac{x_2^2}{s_{22}}+\cdots+\frac{x_p^2}{s_{pp}}}\]</span> If variables <span class="math inline">\(x_1,x_2,\cdots,x_p\)</span> and are correlated, we can rotate the original
coordinate system through the angle <span class="math inline">\(\theta\)</span> while keeping the scatters fixed and label the variables in the rotated axes as <span class="math inline">\(\widetilde x_1,\widetilde x_2,\cdots,\widetilde x_p\)</span>, which are uncorrelated. Then the statistical distance from <span class="math inline">\(\mathbf X\)</span> to origin <span class="math inline">\(\mathbf O\)</span> in the rotated axes is <span class="math display">\[d(\mathbf X,\mathbf O)=\sqrt{\frac{\widetilde x_1^2}{\widetilde s_{11}}+\frac{\widetilde x_2^2}{\widetilde s_{22}}+\cdots+\frac{\widetilde x_p^2}{\widetilde s_{pp}}}=\sqrt{\mathbf x^T\mathbf A\mathbf x}\]</span> with <span class="math inline">\(\mathbf A\)</span> is the rotation matrix: <span class="math display">\[\mathbf A=\begin{bmatrix}
a_{11}&amp;a_{12}&amp;\cdots&amp;a_{1p}\\
a_{12}&amp;a_{22}&amp;\cdots&amp;a_{2p}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
a_{1p}&amp;a_{2p}&amp;\cdots&amp;a_{pp}\\
\end{bmatrix}\]</span> By the spectral decomposition <span class="math display">\[\mathbf A=\sum_{i=1}^{p}\lambda_i\mathbf e_i\mathbf e_i^T\quad (i=1,2,\cdots,p)\]</span> so <span class="math display">\[d^2=\mathbf x^T\mathbf A\mathbf x=\mathbf x^T(\sum_{i=1}^{p}\lambda_i\mathbf e_i\mathbf e_i^T)\mathbf x=\sum_{i=1}^{p}\lambda_i(\mathbf x^T\mathbf e_i)^2\]</span> Let <span class="math inline">\(\lambda_1\ge\lambda_2\ge\cdots\ge\lambda_p\)</span>, then <span class="math inline">\(\mathbf x=d^2\lambda_1^{-1/2}\mathbf e_1\)</span> satisfies <span class="math display">\[\mathbf x^T\mathbf A\mathbf x=\sum_{i=1}^{p}\lambda_i(\mathbf x^T\mathbf e_i)^2=\lambda_1\Bigl[(d^2\lambda_1^{-1/2}\mathbf e_1)^T\mathbf e_1\Bigr]^2=d^2\]</span> and all of the uncorrelated <span class="math inline">\(\mathbf x_i=d\lambda_i^{-1/2}\mathbf e_i\)</span> satisfies <span class="math inline">\(\mathbf x^T\mathbf A\mathbf x=d^2\)</span> Thus, the points at distance <span class="math inline">\(d\)</span> lie on an hyperellipsoids whose axes are given by the eigenvectors of <span class="math inline">\(\mathbf A\)</span> with lengths proportional to the reciprocals of the square roots of the eigenvalues. The constant of proportionality is <span class="math inline">\(d\)</span> and the half-length of the axes of the hyperellipsoid in the direction <span class="math inline">\(\mathbf e_i\)</span> is equal to <span class="math inline">\(\frac{d}{\sqrt{\lambda_i}}\)</span></p></li>
<li><p>Let <span class="math inline">\(\underset{p\times 1}{\mathbf b}\)</span> and <span class="math inline">\(\underset{p\times 1}{\mathbf d}\)</span> be any two vectors, and <span class="math inline">\(\underset{p\times p}{\mathbf B}\)</span> is a positive definite matrix. Then <span class="math display">\[(\mathbf b^T\mathbf d)^2=(\mathbf b^T\mathbf B^{1/2}\mathbf B^{-1/2}\mathbf d)^2=\Bigl((\mathbf B^{1/2}\mathbf b)^T(\mathbf B^{-1/2}\mathbf d)\Bigr)^2\\
\le\Bigl((\mathbf B^{1/2}\mathbf b)^T(\mathbf B^{1/2}\mathbf b)\Bigr)\Bigl((\mathbf B^{-1/2}\mathbf d)^T(\mathbf B^{-1/2}\mathbf d)\Bigr)\\
=(\mathbf b^T\mathbf B\mathbf b)(\mathbf d^T\mathbf B^{-1}\mathbf d)\]</span> with equality if and only if <span class="math inline">\(\mathbf b=c\mathbf B^{-1}\mathbf d\)</span> for some constant c.Â So <span class="math display">\[\underset{\mathbf b\ne\mathbf 0}{\text{max}}\Bigl(\frac{\mathbf b^T\mathbf d}{\sqrt{\mathbf b^T\mathbf B\mathbf b}}\Bigr)=\sqrt{\mathbf d^T\mathbf B^{-1}\mathbf d}\]</span> <strong>The meaning of this maximum is the inner product of two vectors is no more than the product of the lengths of the two vectors with/without rotated by a positive definite matrix and its reverse separately.</strong></p></li>
<li><p>By the spectral decomposition, the hyperellipsoids <span class="math display">\[d^2=\mathbf a^T\boldsymbol\Sigma_{XX}\mathbf a=\mathbf a^T(\sum_{i=1}^{p}\lambda_i\mathbf e_i\mathbf e_i^T)\mathbf a=\sum_{i=1}^{p}\lambda_i(\mathbf a^T\mathbf e_i)^2\quad (i=1,2,\cdots,p)\]</span> where <span class="math inline">\((\lambda_i,\mathbf e_i)\)</span> are the eigenvalue-eigenvector pairs of <span class="math inline">\(\boldsymbol\Sigma_{XX}\)</span> and <span class="math inline">\(\mathbf a_i=d\lambda_i^{-1/2}\mathbf e_i\)</span> is on the hyperellipsoid with the distance to origin <span class="math inline">\(\mathbf O\)</span> in the <span class="math inline">\(\mathbf e_i\)</span> direction is <span class="math inline">\(\frac{d}{\sqrt{\lambda_i}}\)</span> Then <span class="math display">\[U_i=\mathbf a_i^T\mathbf X=(d\lambda_i^{-1/2}\mathbf e_i)^T\mathbf X=d\lambda_i^{-1/2}\mathbf e_i^T\mathbf X=d\mathbf e_i^T\boldsymbol\Sigma_{XX}^{-1/2}\mathbf X\]</span> and <span class="math display">\[V_j=\mathbf b_j^T\mathbf Y=c\kappa_j^{-1/2}\mathbf f_j^T\mathbf Y=c\mathbf f_j^T\boldsymbol\Sigma_{YY}^{-1/2}\mathbf Y\]</span> are the maximum uncorrelated values, where <span class="math inline">\((\kappa_j,\mathbf f_j)\)</span> are the eigenvalue-eigenvector pairs of <span class="math inline">\(\boldsymbol\Sigma_{YY}\)</span> and <span class="math inline">\(d=\sqrt{\mathbf a^T\boldsymbol\Sigma_{XX}\mathbf a}\)</span> and <span class="math inline">\(c=\sqrt{\mathbf b^T\boldsymbol\Sigma_{YY}\mathbf b}\)</span> Then the maximum correlation is <span class="math display">\[Cor(U_k,V_k)=\frac{\mathbf a_k^T\boldsymbol\Sigma_{XY}\mathbf b_k}{\sqrt{\mathbf a_k^T\boldsymbol\Sigma_{XX}\mathbf a_k}\sqrt{\mathbf b_k^T\boldsymbol\Sigma_{YY}\mathbf b_k}}=\frac{d\mathbf e_k^T\boldsymbol\Sigma_{XX}^{-1/2}\boldsymbol\Sigma_{XY}c\boldsymbol\Sigma_{YY}^{-1/2}\mathbf f_k}{dc}=\mathbf e_k^T\boldsymbol\Sigma_{XX}^{-1/2}\boldsymbol\Sigma_{XY}\boldsymbol\Sigma_{YY}^{-1/2}\mathbf f_k\]</span> and <span class="math display">\[Cor^2(U_i,V_j)=\mathbf e_k^T\boldsymbol\Sigma_{XX}^{-1/2}\boldsymbol\Sigma_{XY}\boldsymbol\Sigma_{YY}^{-1/2}\mathbf f_k\mathbf f_k^T\boldsymbol\Sigma_{YY}^{-1/2}\boldsymbol\Sigma_{YX}\boldsymbol\Sigma_{XX}^{-1/2}\mathbf e_k=\mathbf e_k^T\boldsymbol\Sigma_{XX}^{-1/2}\boldsymbol\Sigma_{XY}\boldsymbol\Sigma_{YY}^{-1}\boldsymbol\Sigma_{YX}\boldsymbol\Sigma_{XX}^{-1/2}\mathbf e_k=\rho_k^2\]</span> where <span class="math inline">\(\rho_k^2\)</span> are the eigenvalues of <span class="math inline">\(\boldsymbol\Sigma_{XX}^{-1/2}\boldsymbol\Sigma_{XY}\boldsymbol\Sigma_{YY}^{-1}\boldsymbol\Sigma_{YX}\boldsymbol\Sigma_{XX}^{-1/2}\)</span></p></li>
</ol>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
          </li>
          <li>
          </li>
        </ul>
      </footer>

    </div>
    

    
<script src="../../../../js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

